<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grace - Instagram Callback</title>
    <style>
      :root{
        --bg:#071027;--bg-2:#071733;--card:#07152a;--accent:#7c3aed;--muted:#94a3b8;--glass: rgba(255,255,255,0.03)
      }
      html,body{height:100%}
      body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,var(--bg) 0%, var(--bg-2) 100%);color:#e6eef8;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
      .card{width:1000px;max-width:980px;background:linear-gradient(180deg,var(--glass), rgba(255,255,255,0.01));border-radius:16px;padding:28px;box-shadow:0 12px 40px rgba(2,6,23,0.7);display:flex;gap:28px;align-items:flex-start}
      .brand{flex:1}
      .brand h1{margin:0;font-size:30px;letter-spacing:-0.02em}
      .brand p{color:var(--muted);margin-top:8px;font-size:15px}
      .features{display:flex;gap:10px;margin-top:18px}
      .feature{background:transparent;border:1px solid rgba(255,255,255,0.03);padding:12px;border-radius:10px;display:flex;gap:10px;align-items:center}
      .feature strong{display:block;font-size:14px}
      .actions{display:flex;flex-direction:column;gap:12px;align-items:flex-end}
      .btn{background:linear-gradient(90deg,var(--accent),#5b21b6);color:white;padding:12px 18px;border-radius:12px;border:none;cursor:pointer;font-weight:700;font-size:15px}
      .muted{color:var(--muted)}
      .profile{display:flex;gap:14px;align-items:center}
      .avatar{width:84px;height:84px;border-radius:999px;background:#fff;overflow:hidden;flex-shrink:0;border:4px solid rgba(255,255,255,0.03)}
      .meta p{margin:0}
      .hint{font-size:13px;color:var(--muted);margin-top:8px}
      @media (max-width:920px){
        .card{flex-direction:column;max-width:95%}
        .actions{align-items:stretch}
      }
    </style>
  </head>
  <body>
    <div class="card" role="main">
      <div class="brand">
  <h1>Grace - AI Virtual Business Assistant</h1>
  <p class="muted">Grace connects to Instagram Business accounts to show reviewer profile information and demonstrate requested features - fast, private, and explicit.</p>

        <div class="features" aria-hidden="false">
          <div class="feature">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2v6" stroke="#7c3aed" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 16v6" stroke="#7c3aed" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M4 8h16" stroke="#7c3aed" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <div><strong>Reviewer-ready</strong><span class="muted">Clear consent flow and redirect</span></div>
          </div>
          <div class="feature">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z" stroke="#7c3aed" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <div><strong>Privacy-first</strong><span class="muted">Data deletion & deauth endpoints provided</span></div>
          </div>
          <div class="feature">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 7h18M3 12h10M3 17h18" stroke="#7c3aed" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <div><strong>Simple demo</strong><span class="muted">Instantly shows username, avatar, and id</span></div>
          </div>
        </div>

  <div class="hint">When you're ready, click <strong>Start Login</strong> to open Instagram's consent screen. After approval you'll be returned here and the profile will load automatically.</div>
        <div style="margin-top:16px;display:flex;gap:12px;align-items:center">
          <button class="btn" onclick="location.href='/login'">Start Login</button>
          <a class="muted" href="/privacy" style="text-decoration:none;color:inherit">Privacy</a>
          <a class="muted" href="/terms" style="text-decoration:none;color:inherit;margin-left:8px">Terms</a>
        </div>
      </div>

      <div class="actions">
        <div id="profileBox" style="min-width:260px;display:none" class="profile card-right" aria-live="polite">
          <div class="avatar"><img id="avatar" src="" alt="avatar" style="width:100%;height:100%;object-fit:cover"/></div>
          <div class="meta">
            <p id="username"><strong>Username</strong></p>
            <p id="acctid" class="muted">ID</p>
            <p id="type" class="muted">Type</p>
          </div>
        </div>
        <div id="status" class="muted">Not logged in</div>
      </div>
    </div>

    <script>
      // Fetch reviewer profile and update UI. Keeps previous behavior but with nicer messages.
      async function fetchProfile(){
        try{
          const res = await fetch('/instagram/profile');
          if(!res.ok) throw new Error('no-profile');
          const data = await res.json();
          document.getElementById('avatar').src = data.profile_picture_url || '';
          document.getElementById('username').innerHTML = '<strong>@'+(data.username||'')+'</strong>';
          document.getElementById('acctid').textContent = 'ID: ' + (data.id||'');
          document.getElementById('type').textContent = 'Type: ' + (data.account_type||'');
          document.getElementById('profileBox').style.display = 'flex';
          document.getElementById('status').textContent = 'Logged in - profile loaded âœ…';
        }catch(e){
          // keep message helpful for reviewers
          document.getElementById('status').textContent = 'Not logged in - click Start Login to begin the Instagram consent flow.';
        }
      }
      // try to fetch on load
      fetchProfile();
    </script>
  </body>
</html>
